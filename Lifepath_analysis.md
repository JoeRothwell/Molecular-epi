Lifepath NMR metabolomics analysis
================

### The Lifepath breast cancer study

The breast cancer case-control is nested within the E3N cohort, a French
multicentre prospective study designed to investigate risk factors for
cancer and major non-communicable diseases in women. Of 100,000 women
followed by the study, 25,000 gave blood samples at baseline. A total of
812 BC cases have since been diagnosed and matched to 812 healthy cases
for the case-control.

The following table shows baseline characteristics of
participants.

|                                           | Controls        | Cases           |
| :---------------------------------------- | :-------------- | :-------------- |
| **Total subjects**                        |                 |                 |
| N                                         | 791             | 791             |
| **Age at blood collection (years)**       |                 |                 |
| Mean                                      | 56.81 ± 6.57    | 56.79 ± 6.61    |
| **BMI**                                   |                 |                 |
| Mean (SD)                                 | 23.87 ± 3.96    | 23.73 ± 3.71    |
| **Waist circumference**                   |                 |                 |
| Mean (SD)                                 | 136.10 ± 609.02 | 123.18 ± 497.60 |
| **Menopausal status at blood collection** |                 |                 |
| Pre-menopausal                            | 180 (23)        | 179 (23)        |
| Post-menopausal                           | 611 (77)        | 612 (77)        |
| **Smoking status**                        |                 |                 |
| Yes                                       | 66 (8)          | 62 (8)          |
| No                                        | 725 (92)        | 729 (92)        |
| **Diabetic status**                       |                 |                 |
| No                                        | 759 (96)        | 764 (97)        |
| Yes                                       | 32 (4)          | 27 (3)          |
| **Lifetime alcohol drinking pattern**     |                 |                 |
| Non-consumers (0 g/day)                   | 153 (19)        | 146 (18)        |
| Light consumers (1-10 g/day)              | 334 (42)        | 321 (41)        |
| Drinkers (\>10 g/day)                     | 298 (38)        | 323 (41)        |
| Unknown                                   | 6 (1)           | 1 (0)           |
| **Blood pressure**                        |                 |                 |
| Normal tension                            | 642 (81)        | 653 (83)        |
| Hypertension                              | 143 (18)        | 133 (17)        |
| No information                            | 6 (1)           | 5 (1)           |
| **Previous oral contraceptive use**       |                 |                 |
| Yes                                       | 18 (2)          | 17 (2)          |
| No                                        | 773 (98)        | 774 (98)        |
| **Menopause hormone therapy**             |                 |                 |
| Yes                                       | 437 (55)        | 487 (62)        |
| No                                        | 354 (45)        | 304 (38)        |
| **Time before centrifugation**            |                 |                 |
| \< 12h                                    | 28 (4)          | 28 (4)          |
| \> 12-24h                                 | 689 (87)        | 669 (85)        |
| \> 24h                                    | 68 (9)          | 90 (11)         |
| Unknown                                   | 6 (1)           | 4 (1)           |
| **Fasting status**                        |                 |                 |
| Non-Fasting                               | 504 (64)        | 504 (64)        |
| Fasting                                   | 287 (36)        | 287 (36)        |
| **Storage time (years)**                  |                 |                 |
| Mean (SD)                                 | 13.62 ± 1.11    | 13.65 ± 1.13    |
| **Behavior**                              |                 |                 |
| In situ                                   | 0 (0)           | 69 (9)          |
| Invasive                                  | 0 (0)           | 685 (87)        |
| Unknown                                   | 791 (100)       | 37 (5)          |
| **Subtype**                               |                 |                 |
| Lobular                                   | 0 (0)           | 110 (14)        |
| Ductal                                    | 0 (0)           | 360 (46)        |
| Tubular                                   | 0 (0)           | 25 (3)          |
| Mixed                                     | 0 (0)           | 11 (1)          |
| Others                                    | 0 (0)           | 248 (31)        |
| Unknown                                   | 791 (100)       | 37 (5)          |
| **HER2**                                  |                 |                 |
| Negative                                  | 0 (0)           | 395 (50)        |
| Positive                                  | 0 (0)           | 206 (26)        |
| Unknown                                   | 791 (100)       | 190 (24)        |
| **Estrogen receptor**                     |                 |                 |
| Negative                                  | 498 (63)        | 458 (58)        |
| Positive                                  | 293 (37)        | 333 (42)        |
| Unknown                                   | NA (NA)         | NA (NA)         |
| **Progesterone receptor**                 |                 |                 |
| Negative                                  | 469 (59)        | 415 (52)        |
| Positive                                  | 322 (41)        | 376 (48)        |
| Unknown                                   | NA (NA)         | NA (NA)         |
| **SBR Grade**                             |                 |                 |
| Favorable prognosis                       | 0 (0)           | 221 (28)        |
| Intermediate prognosis                    | 0 (0)           | 291 (37)        |
| Unfavorable prognosis                     | 0 (0)           | 103 (13)        |
| No information                            | 791 (100)       | 176 (22)        |
| **Grade**                                 |                 |                 |
| 1                                         | 0 (0)           | 103 (13)        |
| 2                                         | 0 (0)           | 195 (25)        |
| 3                                         | 0 (0)           | 308 (39)        |
| Unknown                                   | 791 (100)       | 185 (23)        |
| **Stade**                                 |                 |                 |
| 1                                         | 0 (0)           | 421 (53)        |
| 2                                         | 0 (0)           | 195 (25)        |
| 3                                         | 0 (0)           | 37 (5)          |
| 4                                         | 0 (0)           | 2 (0)           |
| No information                            | 791 (100)       | 136 (17)        |
| **Time between sampling and diagnosis**   |                 |                 |
| 5 years or less                           | 0 (0)           | 412 (52)        |
| More than 5 years                         | 0 (0)           | 379 (48)        |
| No information                            | 791 (100)       | 0 (0)           |

### Some background on NMR metabolomics data

NMR measures the spin and magnetic moment properties of the nuclei in a
molecule. These properties can be measured in complex mixtures. The
sample is radiated with a short pulse of high-energy radio frequencies
(typically in the range 100–1000 MHz depending on the field strength)
that excite all nuclei. When they return to the low-energy state, they
emit a pattern of frequencies representing the different energy
emissions from the different nuclei. An NMR spectrum is generated as the
ppm value, or chemical shift, against intensity. Chemical shift is
measured in parts per million (ppm) of the radiation frequency emitted.
The more shielded a nucleus is, the higher the chemical shift.

### Exploratory analysis

Read in metabolomics data from text file. There are 44 compounds
measured for 1623 subjects, and subject identifiers in the first column,
`CODBMB`.

``` r
library(tidyverse)
ints <- read_tsv("1507_XMetabolite_std_cpmg_E3N.txt")
dim(ints)
```

    ## [1] 1623   45

``` r
colnames(ints)
```

    ##  [1] "CODBMB"                   "3Hydroxybutyrate"        
    ##  [3] "Acetate"                  "Acetoacetate"            
    ##  [5] "Acetone"                  "Albumin"                 
    ##  [7] "Cholesterol"              "Choline"                 
    ##  [9] "cis-Aconitate"            "Creatine"                
    ## [11] "Creatinine"               "Glucose"                 
    ## [13] "Mannose"                  "Dimethylamine"           
    ## [15] "Ethanol"                  "Fatty acid"              
    ## [17] "Fatty acid (mainly LDL)"  "Fatty acid (mainly VLDL)"
    ## [19] "Formate"                  "Glutamine"               
    ## [21] "Glycerol"                 "Glycerophosphocholine"   
    ## [23] "Glycine"                  "Hypoxanthine"            
    ## [25] "Inosine"                  "Alanine"                 
    ## [27] "Aspartate"                "Glutamate"               
    ## [29] "Histidine"                "Isoleucine"              
    ## [31] "Lactate"                  "Lysine"                  
    ## [33] "Methionine"               "Ornithine"               
    ## [35] "Phenylalanine"            "Proline"                 
    ## [37] "Tyrosine"                 "Valine"                  
    ## [39] "Leucine"                  "Malonate"                
    ## [41] "Methanol"                 "NAC 1"                   
    ## [43] "NAC 2"                    "Pyruvate"                
    ## [45] "Succinate"

The metabolomics data are previewed as follows:

``` r
library(kableExtra)
knitr::kable(ints[1:5, 1:10], format = "html")
```

<table>

<thead>

<tr>

<th style="text-align:right;">

CODBMB

</th>

<th style="text-align:right;">

3Hydroxybutyrate

</th>

<th style="text-align:right;">

Acetate

</th>

<th style="text-align:right;">

Acetoacetate

</th>

<th style="text-align:right;">

Acetone

</th>

<th style="text-align:right;">

Albumin

</th>

<th style="text-align:right;">

Cholesterol

</th>

<th style="text-align:right;">

Choline

</th>

<th style="text-align:right;">

cis-Aconitate

</th>

<th style="text-align:right;">

Creatine

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:right;">

11091606

</td>

<td style="text-align:right;">

\-0.9156109

</td>

<td style="text-align:right;">

0.5779014

</td>

<td style="text-align:right;">

\-0.2022630

</td>

<td style="text-align:right;">

0.4908649

</td>

<td style="text-align:right;">

\-0.7957576

</td>

<td style="text-align:right;">

\-0.5941070

</td>

<td style="text-align:right;">

0.4695364

</td>

<td style="text-align:right;">

\-0.6115322

</td>

<td style="text-align:right;">

\-0.3046721

</td>

</tr>

<tr>

<td style="text-align:right;">

11102513

</td>

<td style="text-align:right;">

\-0.0815741

</td>

<td style="text-align:right;">

\-0.4824284

</td>

<td style="text-align:right;">

\-0.4308603

</td>

<td style="text-align:right;">

\-0.4714970

</td>

<td style="text-align:right;">

\-0.6462590

</td>

<td style="text-align:right;">

\-1.5475994

</td>

<td style="text-align:right;">

\-1.4772020

</td>

<td style="text-align:right;">

\-0.1711129

</td>

<td style="text-align:right;">

\-0.2186251

</td>

</tr>

<tr>

<td style="text-align:right;">

11048476

</td>

<td style="text-align:right;">

\-0.7071017

</td>

<td style="text-align:right;">

\-0.3987182

</td>

<td style="text-align:right;">

\-0.6213580

</td>

<td style="text-align:right;">

\-0.0694977

</td>

<td style="text-align:right;">

\-0.7210083

</td>

<td style="text-align:right;">

\-0.4429435

</td>

<td style="text-align:right;">

\-1.2927741

</td>

<td style="text-align:right;">

\-0.2740681

</td>

<td style="text-align:right;">

\-0.1325781

</td>

</tr>

<tr>

<td style="text-align:right;">

11059124

</td>

<td style="text-align:right;">

0.0748078

</td>

<td style="text-align:right;">

0.1035433

</td>

<td style="text-align:right;">

0.8835738

</td>

<td style="text-align:right;">

0.1863200

</td>

<td style="text-align:right;">

1.8802665

</td>

<td style="text-align:right;">

\-1.3731801

</td>

<td style="text-align:right;">

\-1.8460577

</td>

<td style="text-align:right;">

3.2607253

</td>

<td style="text-align:right;">

1.5883620

</td>

</tr>

<tr>

<td style="text-align:right;">

11102399

</td>

<td style="text-align:right;">

\-1.1970983

</td>

<td style="text-align:right;">

\-0.3708147

</td>

<td style="text-align:right;">

\-0.2213128

</td>

<td style="text-align:right;">

0.1497746

</td>

<td style="text-align:right;">

\-0.4668608

</td>

<td style="text-align:right;">

\-1.3499242

</td>

<td style="text-align:right;">

\-0.5243247

</td>

<td style="text-align:right;">

0.0004790

</td>

<td style="text-align:right;">

0.3406805

</td>

</tr>

</tbody>

</table>

Intensity data are both positive and negative and most values in between
-2 and 2. Data appear to be scaled and centered. We can plot the total
intensity of each metabolite, being sure first to remove the ID
column:

``` r
plot(colSums(ints[ , -1]), xlab = "Compound number", ylab = "Scaled intensity",
     pch = 19, col = "dodgerblue", main = "Summed intensities of 44 metabolites", font.main = 1)
```

<img src="Lifepath_analysis_files/figure-gfm/totalint-1.png" style="display: block; margin: auto;" />

*Summed intensities of 44 serum metabolites measured by NMR.*

Total intensities are similar between compounds and normally
distributed.We can now look at correlations between compounds:

``` r
cormat <- cor(ints)
colnames(cormat) <- NULL
library(corrplot)
corrplot(cormat, method = "square", tl.col = "black", tl.cex = 0.8)
```

<img src="Lifepath_analysis_files/figure-gfm/corr-1.png" style="display: block; margin: auto;" />

*Inter-compound correlations.*

Of note is that the three fatty acid variables are correlated, as well
as valine and leucine and NAC1 and NAC2. Next we can plot a PCA of the
compound profiles:

``` r
ints <- ints[ , -1]
pca <- prcomp(ints, scale.=F)
library(pca3d)
pca2d(pca)
title("Metabolite profiles of 1623 subjects", font.main = 1)
box(which = "plot", lty = "solid")
```

<img src="Lifepath_analysis_files/figure-gfm/pca-1.png" style="display: block; margin: auto;" />

*Scores plot of metabolic profiles of 1623 subjects in the Lifepath
study.*

There are no obvious batch effects or patterns in the data.

There is one notable outlying profile in the bottom right-hand corner of
the plot. This could be caused by a technical issue with the sample. We
can find the identity of this, remove it from the dataset and rerun the
PCA. The biplot shows us the variables loading most strongly onto PC1
and PC2.

``` r
which(pca$x[, 2] < -10)
```

    ## [1] 1409

``` r
pca1 <- prcomp(ints[-1409, -1], scale.=F)
pca2d(pca1, biplot = T)
title("Metabolite profiles of 1623 subjects with loadings", font.main = 1)
box(which = "plot", lty = "solid")
```

<img src="Lifepath_analysis_files/figure-gfm/outlier-removal-1.png" style="display: block; margin: auto;" />

*Biplot of metabolic profiles in the Lifepath study (n = 1622).*

PC1 is characterised by relative concentrations of fatty acid, lysine
and ornithine. PC2 is characterised by relative concentrations of
creatinine, isoleucine and glycerophosphocholine.

### PCPR2 analysis to find sources of variation in data

The following variables have been hypothesised to contribute to
variation in metabolomics data: week of NMR analysis, collection centre,
age, BMI, menopausal status, smoking status, diabetic status, fasting
status, time before centrifugation, storage time, year of collection.
PCPR2 was therefore performed on this set of Y-variables and the
X-matrix of NMR intensity
values.

<img src="Lifepath_analysis_files/figure-gfm/pcpr2-1.png" style="display: block; margin: auto;" />

Of the variables included, centre of blood collection (PLACE)
contributed most to variation in metabolomics
data.

### Risk models for lifestyle variables and serum metabolite concentrations

BC case-control status was modelled by the non-matching factors BMI,
smoking status and diabetes
status.

<img src="Lifepath_analysis_files/figure-gfm/clr-model-1.png" style="display: block; margin: auto;" />

None of BMI, smoking status or diabetes status were significantly
associated with BC.

The 44 metabolites were then added to the model, adjusting for BMI,
smoking status and diabetes
status.

<img src="Lifepath_analysis_files/figure-gfm/clr2-model-1.png" style="display: block; margin: auto;" />

Hypoxanthine and inosine concentrations were associated with increased
risk of BC. NAC1 and NAC2 were borderline associated with with increased
risk of BC.
